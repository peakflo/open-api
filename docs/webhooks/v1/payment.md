# Payments

## Payment created

The PAYMENT_CREATED is triggered when there is a new payment created within peakflo. The externalId passed by peakflo here must be used when you are using peakflo api to update the same payment. The request body looks like this

```json
{
  "eventId" : "ca77d168-8fab-4d7d-a156-fdac4df43ef0",
  "eventType" : "PAYMENT_CREATED",
  "eventCreatedAt" : "2021-04-05T14:48:00.000Z",
  "payments" : [{
      "paymentId" : "639bac74aff54497ba804e6f1ea09929",
      "externalId" : "0a5f41fe-3c8f-4d24-82e6-90bde4068934",
      "customerRef": "123edaFgds2",
      "status" : "deposited"
      "totalAmount": 346,
      "remainingAmount": 0,
      "currency": "USD",
      "currencyRate": 0,
      "paymentFee": 0,
      "paymentCreatedAt": "2021-04-05T14:43:00.000Z",
      "paymentLines": [
        {
          "amount": 346,
          "type": "Invoice",
          "id": "028f532be69d4ca49ccb54a385bcd4e5",
          "currencyRate": 0
        }
      ]
      "reference": "PF02300020100",
      "note": "payment towards invoice for logistics"
  }]
}
```


## Payment updated

The PAYMENT_UPDATED is triggered when an existing payment with same reference is updated. The request body looks like this

```json
{
  "eventId" : "45645666aff54497ba804e6f1ea09929",
  "eventType" : "PAYMENT_UPDATED",
  "eventCreatedAt" : "2021-04-05T14:48:00.000Z",
  "payments" : [{
      "paymentId" : "639bac74aff54497ba804e6f1ea09929",
      "externalId" : "63bf352f-4531-4967-92c2-e65c51f39e65",
      "customerRef": "123edaFgds2",
      "status" : "deposited"
      "totalAmount": 346,
      "remainingAmount": 0,
      "currency": "USD",
      "currencyRate": 0,
      "paymentFee": 0,
      "paymentCreatedAt": "2021-04-05T14:43:00.000Z",
      "paymentLines": [
        {
          "amount": 346,
          "type": "Invoice",
          "id": "028f532be69d4ca49ccb54a385bcd4e5",
          "currencyRate": 0
        }
      ]
      "reference": "PF02300020100",
      "note": "payment towards invoice for logistics"
  }]
}
```
## Payment deleted

The PAYMENT_DELETED is triggered when an existing payment is deleted. The request body looks like this

```json
{
  "eventId" : "45645666aff54497ba804e6f1ea09929",
  "eventType" : "PAYMENT_DELETED",
  "eventCreatedAt" : "2021-04-05T14:48:00.000Z",
  "payments" : [{
      "paymentId" : "639bac74aff54497ba804e6f1ea09929",
      "externalId" : "63bf352f-4531-4967-92c2-e65c51f39e65",
      "customerRef": "123edaFgds2",
      "status" : "deposited"
      "totalAmount": 346,
      "remainingAmount": 0,
      "currency": "USD",
      "currencyRate": 0,
      "paymentFee": 0,
      "paymentCreatedAt": "2021-04-05T14:43:00.000Z",
      "paymentLines": [
        {
          "amount": 346,
          "type": "Invoice",
          "id": "028f532be69d4ca49ccb54a385bcd4e5",
          "currencyRate": 0
        }
      ]
      "reference": "PF02300020100",
      "note": "payment towards invoice for logistics"
  }]
}
```


Payments fields details

Property | type | description
---------|----------|---------
 paymentId | string | The payment Id
 externalId | string | The unique reference Id. Generated by peakflo if source of payment is peakflo.
 customerRef | string | The customer reference Id
 totalAmount | string | Total payment amount 
 remainingAmount | string | The remaining amount
 currency |string | Payment currency in ISO
 currencyRate | string | Payment currency rate compared to your base currency
paymentCreatedAt | ISO date time | Payment created date time
reference | string | Payment reference
note |string | Note, if any

Payment lines fields


Property | type | description
---------|----------|---------
 amount | string | invoice amount
 type | string | Invoice or Refund
 id | string | invoice Id
 currencyRate | string | The currency rate
